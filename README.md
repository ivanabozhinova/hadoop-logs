# Домашна задача – Hadoop и Map-Reduce
### Група 37

* Андреј Гаштеовски 111035 [@andrejgasteovski](https://github.com/andrejgasteovski)
* Ивана Божинова 111023 [@ivanabozhinova](https://github.com/ivanabozhinova)
* Сандра Деловска 111043 [@Sandra012](https://github.com/Sandra012)
* Ева Танаскоска 122124

## Опис на проблемот
Податоците од log датотеките можат да послужат за стекнување на многу информации кои се од големо значење.  Во склоп на оваа задача ние сакаме да извлечеме корисни информации обработувајќи log датотека превземена од материјалите на udacity.org од курсот за Hadoop. За download е достапна на следниот [линк](http://content.udacity-data.com/courses/ud617/access_log.gz) (~500MB).
Датотеката содржи 44477844 линии во следниот формат:

`Ip_address	- -	timestamp	“request type	File “	bytes	cs`

На пример:

`10.223.157.186 - - [15/Jul/2009:15:50:36] "GET	RagingPhoenix_2DSleeve.jpeg “	200	168`

#### Цел: да да ги излистаме сите IP адреси од кои бил отворен секој фајл во текот на еден месец. 

Ова значи дека сакаме да добиеме излез во следниот формат:

`month	file		[ip_address_1	ip_address2	ip_address_3	...]`

#### Зошто Hadoop и Map-Reduce
Секој клик на веб страна креира околу 100 бајти податоци во типичен лог. Како последица на ова може да се генерираат стотици гигабајти податоци за еден ден. Издвојувањето на информациите кои ни требаат од оваа огромна маса податоци побарува повеќе од обичен секвенцијален алгоритам. 

## Изворен код	
[Logs.java](https://github.com/ivanabozhinova/hadoop-logs/blob/master/Logs.java)

Бидејќи целта ни е клуч во мапата да се месецот и пристапената датотека, креиравме класа FileAccess која ги содржи истите. 
За секој ред во влезната датотека, секој mapper креира објект од FileAcces како клуч и му доделува вредност еднава на IP адресата од која бил направен пристапот. 
Потоа reducer-от ги зема сите IP адреси кои имаат ист клуч и ги става во еден TreeSet. Структурата Set ја користиме за да избегнеме повторување на IP адресите. 
Со оглед на тоа што не секоја линија во логот ја има посакуваната структура, се вршат проверки во класата Map.

## Резултати
Програмата е извршена на виртуелната машина на cloudera. На сликите е прикажан дел од излезот од командата за извршување.
![](http://i.imgur.com/Gi2asil.png)
![](http://i.imgur.com/2MmsZw5.png)
 
 Целосниот излез е достапен во датотеката out.txt.
 
## Излезна датотека

Излезната датотека содржи 176986 линии во бараниот формат. Неколку од нив се:
```
Sep	/release-schedule/ sch.php	[10.118.250.30, 10.220.112.1]
Oct	/release-schedule/ sch.php 	[10.118.250.30, 10.14.237.135, 10.143.126.177, 10.95.232.88]
Oct	/release-schedule/ sdh.php	[10.124.148.99, 10.146.140.55, 10.175.21.83, 10.232.98.236, 10.7.189.2, 10.95.232.88]
```
